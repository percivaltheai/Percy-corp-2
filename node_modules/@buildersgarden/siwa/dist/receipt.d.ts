/**
 * receipt.ts
 *
 * Stateless HMAC-signed verification receipts.
 *
 * A receipt proves that onchain registration was checked during SIWA sign-in.
 * It is issued after successful verification and attached to every subsequent
 * request alongside an ERC-8128 HTTP signature.
 *
 * Receipt alone is useless (can't forge signatures).
 * Signature alone is insufficient (proves key control, not registration).
 * Together = authentication + authorization.
 *
 * Format: base64url(json).base64url(hmac-sha256)
 * Same token format as nonce tokens in siwa.ts.
 */
import type { SignerType } from './signer/index.js';
export interface ReceiptPayload {
    address: string;
    agentId: number;
    agentRegistry: string;
    chainId: number;
    verified: 'offline' | 'onchain';
    signerType?: SignerType;
    iat: number;
    exp: number;
}
export interface ReceiptOptions {
    secret: string;
    ttl?: number;
}
export interface ReceiptResult {
    receipt: string;
    expiresAt: string;
}
/** Default receipt validity: 30 minutes */
export declare const DEFAULT_RECEIPT_TTL: number;
/**
 * Create an HMAC-signed receipt token.
 *
 * @param payload  Agent identity fields from a successful SIWA verification
 * @param options  HMAC secret and optional TTL override
 * @returns        `{ receipt, expiresAt }` â€” the token and its ISO expiry
 */
export declare function createReceipt(payload: Omit<ReceiptPayload, 'iat' | 'exp'>, options: ReceiptOptions): ReceiptResult;
/**
 * Verify and decode a receipt token.
 *
 * Uses constant-time comparison and checks expiry.
 *
 * @param receipt  The `base64url(json).base64url(hmac)` token
 * @param secret   HMAC secret used to sign the receipt
 * @returns        Decoded payload, or `null` if invalid/expired
 */
export declare function verifyReceipt(receipt: string, secret: string): ReceiptPayload | null;
